	<html>
	<head>
	<link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css">
	<script src="//code.jquery.com/jquery-1.11.0.min.js"></script>
	<script src="http://cdnjs.cloudflare.com/ajax/libs/react/0.11.1/JSXTransformer.js"></script>
	<script src="http://cdnjs.cloudflare.com/ajax/libs/react/0.11.1/react.js"></script>
	<script>
	function getlinks(param) {
		var url = "/search_results"+"?search_term="+param
		console.log(url)
		$.getJSON( url, function( data ) {
			var h = '<div class="container">';
			var column_count = 0

			data.forEach(function(entry) {
				if (column_count % 4 == 0)
					h+= '<div class="row">'

				var poster = entry["urlPoster"];
				var link = entry["urlIMDB"];
				var imdb_rating = entry["imdb_rating"]
				var critics_score = entry["critics_score"]
				var audience_score = entry["audience_score"]
				var critics_rating = entry["critics_rating"]
				var audience_rating = entry["audience_rating"]

				var title = entry["title"]


				h += '<div class="col-lg-3 col-md-4 col-sm-6 col-xs-6"><div class="thumbnail"><img src="'+poster+'" width="90" height="90"><div class="caption"><p class="bg-success" align="center"><a href="'+link+'" class="btn btn-primary" role="button" target = "_blank">'+title+'</a></p>'

				h+= '<p align="center">'
				if (imdb_rating > 0)

					h+= '<img src="/assets/imdb_rating.png" width="30" height="30"><span class="badge">'+imdb_rating+'</span>'

				if (critics_score > 0)
					if (critics_rating === "Certified Fresh")
						h+='<img src="/assets/certified_fresh.png" width="30" height="30"><span class="badge">'+critics_score+'</span>'
					else if (critics_rating === "Fresh")
						h+='<img src="/assets/fresh.png" width="30" height="30"><span class="badge">'+critics_score+'</span>'
					else
						h+='<img src="/assets/rotten.png" width="30" height="30"><span class="badge">'+critics_score+'</span>'

				if (audience_score > 0)
					if (audience_rating === "Spilled")
						h+='<img src="/assets/spilled.png" width="30" height="30"><span class="badge">'+audience_score+'</span>'
					else
						h+='<img src="/assets/popcorn.png" width="30" height="30"><span class="badge">'+audience_score+'</span>'
				h+= '</p>'
				h+= '</div></div></div>'
				if (column_count % 4 == 3)
					h+= '</div>'
				column_count = column_count + 1
			});

			h+= '</div>'
			$("#d1").html(h);
		});
	}

	function getSearchTerms() {
		$.getJSON( "/search_terms", function( data ) {
			var h = "";

			data.forEach(function(entry) {

			var term = entry["term"];
			// console.log('Adding term:'+term);

			h += "<a class='btn btn-default'>"+term+"</a>";
			});

			$("#selection_buttons").html(h);
		});
	}

	function addSearchTermButtonClicked(){
		var searchterm = $('#addsearchtermtextbox').val();
		// console.log('search term '+searchterm);
		var url = "/search_terms"+"?term="+searchterm
		// console.log(url)
		$.post(url, function(){
			getSearchTerms();
		});				
	}

	function searchByTerm(e){
		var param = $(e.target).text();
		$('#selection_buttons').find('.btn-success').removeClass("btn-success");
		$(e.target).addClass("btn btn-success");

		h = "loading..."
		$("#d1").html(h);

		getlinks(param);		
	}

	function documentIsReady(){
		getSearchTerms();	
		$('#addsearchtermbutton').click(addSearchTermButtonClicked);

		$('body').on("click", ".btn", searchByTerm);
	}

	$( document ).ready(documentIsReady);

	</script>
	</head>
	<body>
	<div id="selection_buttons"></div>
	<div style="padding:16px;">
		Add a search term : <input id="addsearchtermtextbox" type="textbox" value=""></input>
		<button id="addsearchtermbutton">Click Me</button>
	</div>
	<div id="d1"></div>
	<script type="text/jsx">
      /** @jsx React.DOM */
      React.renderComponent(
        <h4>Getting search terms...</h4>,
        document.getElementById('selection_buttons')
      );
      React.renderComponent(
        <h4>click on a search term...</h4>,
        document.getElementById('d1')
      );
    </script>
	</body>
	</html>